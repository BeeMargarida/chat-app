{"version":3,"sources":["store/utility.js","store/reducers/auth.js","store/actions/actionTypes.js","store/reducers/nav.js","store/reducers/message.js","hoc/hoc.js","settings.js","websocket.js","containers/Chat.js","routes.js","store/actions/auth.js","store/actions/message.js","components/Contact.js","containers/Sidepanel.js","store/actions/nav.js","containers/Profile.js","containers/Form.js","containers/Popup.js","App.js","index.js"],"names":["updateObject","oldObject","updatedProperties","Object","objectSpread","initialState","token","username","error","loading","reducer","state","arguments","length","undefined","action","type","authStart","authSuccess","authFail","authLogout","showAddChatPopup","openAddChatPopup","closeAddChatPopup","messages","chats","toConsumableArray","concat","message","addMessage","reverse","setMessages","setChats","Hoc","props","children","HOST_URL","SOCKET_URL","WebSocketService","classCallCheck","this","callbacks","socketRef","instance","chatUrl","_this","path","WebSocket","onopen","console","log","onmessage","e","socketNewMessage","data","onerror","onclose","connect","close","parsedData","JSON","parse","command","keys","chatId","sendMessage","from","content","messagesCallback","newMessageCallback","send","stringify","err","readyState","WebSocketInstance","getInstance","Chat","possibleConstructorReturn","getPrototypeOf","call","messageChangeHandler","event","setState","target","value","sendMessageHandler","preventDefault","messageObject","match","params","chatID","newChatMessage","renderTimestamp","timestamp","timeDiff","Math","round","Date","getTime","renderMessages","currentUser","map","i","arr","react_default","a","createElement","key","id","style","marginBottom","className","author","src","alt","scrollToBottom","messagesEnd","scrollIntoView","behavior","initialiseChat","_this2","waitForSocketConnection","fetchMessages","callback","component","setTimeout","newProps","_this3","disconnect","_this4","hoc","float","clear","ref","el","onSubmit","onChange","required","placeholder","aria-hidden","React","Component","auth","BaseRouter","Route","exact","logout","localStorage","removeItem","checkAuthTimeout","expirationTime","dispatch","getUserChats","axios","defaults","headers","Content-Type","Authorization","get","then","res","Contact","NavLink","to","chatURL","color","status","picURL","name","antIcon","icon","fontSize","spin","Sidepanel","loginForm","changeForm","authenticate","login","password","signup","email","password2","waitForAuthDetails","addChat","activeChats","c","components_Contact","indicator","isAuthenticated","onClick","method","htmlFor","userName","post","expirationDate","setItem","catch","actions","password1","messageActions","Profile","Redirect","FormItem","Form","Item","HorizontalAddChatForm","usernames","handleChange","handleSubmit","form","validateFields","values","combined","participants","history","push","fieldsError","_this$props$form","getFieldDecorator","getFieldsError","getFieldError","userNameError","isFieldTouched","es_form","layout","validateStatus","help","rules","es_select","mode","width","es_button","htmlType","disabled","some","field","AddChatForm","create","withRouter","AddChatModal","modal","centered","footer","visible","isVisible","onCancel","App","addCallbacks","bind","assertThisInitialized","onTryAutoSignup","BrowserRouter","containers_Sidepanel","Popup","containers_Profile","routes","nav","authenticated","getItem","composeEnhancers","window","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","store","rootReducer","combineReducers","authReducer","navReducer","messageReducer","createStore","applyMiddleware","thunk","configureStore","app","es","src_App","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.14c9eacb.chunk.js","sourcesContent":["export const updateObject = (oldObject, updatedProperties) => {\n  return {\n    ...oldObject,\n    ...updatedProperties\n  };\n};\n","import * as actionTypes from \"../actions/actionTypes\";\nimport { updateObject } from \"../utility\";\n\nconst initialState = {\n  token: null,\n  username: null,\n  error: null,\n  loading: false\n};\n\nconst authStart = (state, action) => {\n  return updateObject(state, {\n    error: null,\n    loading: true\n  });\n};\n\nconst authSuccess = (state, action) => {\n  return updateObject(state, {\n    token: action.token,\n    username: action.username,\n    error: null,\n    loading: false\n  });\n};\n\nconst authFail = (state, action) => {\n  return updateObject(state, {\n    error: action.error,\n    loading: false\n  });\n};\n\nconst authLogout = (state, action) => {\n  return updateObject(state, {\n    token: null,\n    username: null\n  });\n};\n\nconst reducer = (state = initialState, action) => {\n  switch (action.type) {\n    case actionTypes.AUTH_START:\n      return authStart(state, action);\n    case actionTypes.AUTH_SUCCESS:\n      return authSuccess(state, action);\n    case actionTypes.AUTH_FAIL:\n      return authFail(state, action);\n    case actionTypes.AUTH_LOGOUT:\n      return authLogout(state, action);\n    default:\n      return state;\n  }\n};\n\nexport default reducer;\n","export const AUTH_START = \"AUTH_START\";\nexport const AUTH_SUCCESS = \"AUTH_SUCCESS\";\nexport const AUTH_FAIL = \"AUTH_FAIL\";\nexport const AUTH_LOGOUT = \"AUTH_LOGOUT\";\nexport const OPEN_ADD_CHAT_POPUP = \"OPEN_ADD_CHAT_POPUP\";\nexport const CLOSE_ADD_CHAT_POPUP = \"CLOSE_ADD_CHAT_POPUP\";\nexport const ADD_MESSAGE = \"ADD_MESSAGE\";\nexport const SET_MESSAGES = \"SET_MESSAGES\";\nexport const GET_CHATS_SUCCESS = \"GET_CHATS_SUCCESS\";\n","import * as actionTypes from \"../actions/actionTypes\";\nimport { updateObject } from \"../utility\";\n\nconst initialState = {\n  showAddChatPopup: false\n};\n\nconst openAddChatPopup = (state, action) => {\n  return updateObject(state, { showAddChatPopup: true });\n};\n\nconst closeAddChatPopup = (state, action) => {\n  return updateObject(state, { showAddChatPopup: false });\n};\n\nconst reducer = (state = initialState, action) => {\n  switch (action.type) {\n    case actionTypes.OPEN_ADD_CHAT_POPUP:\n      return openAddChatPopup(state, action);\n    case actionTypes.CLOSE_ADD_CHAT_POPUP:\n      return closeAddChatPopup(state, action);\n    default:\n      return state;\n  }\n};\n\nexport default reducer;\n","import * as actionTypes from \"../actions/actionTypes\";\nimport { updateObject } from \"../utility\";\n\nconst initialState = {\n  messages: [],\n  chats: []\n};\n\nconst addMessage = (state, action) => {\n  return updateObject(state, {\n    messages: [...state.messages, action.message]\n  });\n};\n\nconst setMessages = (state, action) => {\n  return updateObject(state, {\n    messages: action.messages.reverse()\n  });\n};\n\nconst setChats = (state, action) => {\n  return updateObject(state, {\n    chats: action.chats\n  });\n};\n\nconst reducer = (state = initialState, action) => {\n  switch (action.type) {\n    case actionTypes.ADD_MESSAGE:\n      return addMessage(state, action);\n    case actionTypes.SET_MESSAGES:\n      return setMessages(state, action);\n    case actionTypes.GET_CHATS_SUCCESS:\n      return setChats(state, action);\n    default:\n      return state;\n  }\n};\n\nexport default reducer;\n","const Hoc = props => props.children;\n\nexport default Hoc;\n","let DEBUG = true;\nlet HOST_URL = \"\";\nlet SOCKET_URL = \"\";\nif (DEBUG) {\n  HOST_URL = \"http://127.0.0.1:8000\";\n  SOCKET_URL = \"ws://127.0.0.1:8000\";\n}\n\nexport { HOST_URL, SOCKET_URL };\n","import { SOCKET_URL } from \"./settings\";\n\nclass WebSocketService {\n  static instance = null;\n  callbacks = {};\n\n  static getInstance() {\n    if (!WebSocketService.instance) {\n      WebSocketService.instance = new WebSocketService();\n    }\n    return WebSocketService.instance;\n  }\n\n  constructor() {\n    this.socketRef = null;\n  }\n\n  connect(chatUrl) {\n    const path = `${SOCKET_URL}/ws/chat/${chatUrl}/`;\n    this.socketRef = new WebSocket(path);\n    this.socketRef.onopen = () => {\n      console.log(\"WebSocket open\");\n    };\n    this.socketRef.onmessage = e => {\n      this.socketNewMessage(e.data);\n    };\n    this.socketRef.onerror = e => {\n      console.log(e.message);\n    };\n    this.socketRef.onclose = () => {\n      console.log(\"WebSocket closed let's reopen\");\n      this.connect();\n    };\n  }\n\n  disconnect() {\n    this.socketRef.close();\n  }\n\n  socketNewMessage(data) {\n    const parsedData = JSON.parse(data);\n    const command = parsedData.command;\n    if (Object.keys(this.callbacks).length === 0) {\n      return;\n    }\n    if (command === \"messages\") {\n      this.callbacks[command](parsedData.messages);\n    }\n    if (command === \"new_message\") {\n      this.callbacks[command](parsedData.message);\n    }\n  }\n\n  fetchMessages(username, chatId) {\n    this.sendMessage({\n      command: \"fetch_messages\",\n      username: username,\n      chatId: chatId\n    });\n  }\n\n  newChatMessage(message) {\n    this.sendMessage({\n      command: \"new_message\",\n      from: message.from,\n      message: message.content,\n      chatId: message.chatId\n    });\n  }\n\n  addCallbacks(messagesCallback, newMessageCallback) {\n    this.callbacks[\"messages\"] = messagesCallback;\n    this.callbacks[\"new_message\"] = newMessageCallback;\n  }\n\n  sendMessage(data) {\n    try {\n      this.socketRef.send(JSON.stringify({ ...data }));\n    } catch (err) {\n      console.log(err.message);\n    }\n  }\n\n  state() {\n    return this.socketRef.readyState;\n  }\n}\n\nconst WebSocketInstance = WebSocketService.getInstance();\n\nexport default WebSocketInstance;\n","import React from \"react\";\nimport { connect } from \"react-redux\";\nimport WebSocketInstance from \"../websocket\";\nimport Hoc from \"../hoc/hoc\";\n\nclass Chat extends React.Component {\n  state = { message: \"\" };\n\n  initialiseChat() {\n    this.waitForSocketConnection(() => {\n      WebSocketInstance.fetchMessages(\n        this.props.username,\n        this.props.match.params.chatID\n      );\n    });\n    WebSocketInstance.connect(this.props.match.params.chatID);\n  }\n\n  constructor(props) {\n    super(props);\n    this.initialiseChat();\n  }\n\n  waitForSocketConnection(callback) {\n    const component = this;\n    setTimeout(function() {\n      if (WebSocketInstance.state() === 1) {\n        console.log(\"Connection is made\");\n        callback();\n        return;\n      } else {\n        console.log(\"wait for connection...\");\n        component.waitForSocketConnection(callback);\n      }\n    }, 100);\n  }\n\n  messageChangeHandler = event => {\n    this.setState({ message: event.target.value });\n  };\n\n  sendMessageHandler = e => {\n    e.preventDefault();\n    const messageObject = {\n      from: this.props.username,\n      content: this.state.message,\n      chatId: this.props.match.params.chatID\n    };\n    WebSocketInstance.newChatMessage(messageObject);\n    this.setState({ message: \"\" });\n  };\n\n  renderTimestamp = timestamp => {\n    let prefix = \"\";\n    const timeDiff = Math.round(\n      (new Date().getTime() - new Date(timestamp).getTime()) / 60000\n    );\n    if (timeDiff < 1) {\n      // less than one minute ago\n      prefix = \"just now...\";\n    } else if (timeDiff < 60 && timeDiff > 1) {\n      // less than sixty minutes ago\n      prefix = `${timeDiff} minutes ago`;\n    } else if (timeDiff < 24 * 60 && timeDiff > 60) {\n      // less than 24 hours ago\n      prefix = `${Math.round(timeDiff / 60)} hours ago`;\n    } else if (timeDiff < 31 * 24 * 60 && timeDiff > 24 * 60) {\n      // less than 7 days ago\n      prefix = `${Math.round(timeDiff / (60 * 24))} days ago`;\n    } else {\n      prefix = `${new Date(timestamp)}`;\n    }\n    return prefix;\n  };\n\n  renderMessages = messages => {\n    const currentUser = this.props.username;\n    return messages.map((message, i, arr) => (\n      <li\n        key={message.id}\n        style={{ marginBottom: arr.length - 1 === i ? \"300px\" : \"15px\" }}\n        className={message.author === currentUser ? \"sent\" : \"replies\"}\n      >\n        <img\n          src=\"http://emilcarlsson.se/assets/mikeross.png\"\n          alt=\"profile-pic\"\n        />\n        <p>\n          {message.content}\n          <br />\n          <small>{this.renderTimestamp(message.timestamp)}</small>\n        </p>\n      </li>\n    ));\n  };\n\n  scrollToBottom = () => {\n    this.messagesEnd.scrollIntoView({ behavior: \"smooth\" });\n  };\n\n  componentDidMount() {\n    this.scrollToBottom();\n  }\n\n  componentDidUpdate() {\n    this.scrollToBottom();\n  }\n\n  componentWillReceiveProps(newProps) {\n    if (this.props.match.params.chatID !== newProps.match.params.chatID) {\n      WebSocketInstance.disconnect();\n      this.waitForSocketConnection(() => {\n        WebSocketInstance.fetchMessages(\n          this.props.username,\n          newProps.match.params.chatID\n        );\n      });\n      WebSocketInstance.connect(newProps.match.params.chatID);\n    }\n  }\n\n  render() {\n    return (\n      <Hoc>\n        <div className=\"messages\">\n          <ul id=\"chat-log\">\n            {this.props.messages && this.renderMessages(this.props.messages)}\n            <div\n              style={{ float: \"left\", clear: \"both\" }}\n              ref={el => {\n                this.messagesEnd = el;\n              }}\n            />\n          </ul>\n        </div>\n        <div className=\"message-input\">\n          <form onSubmit={this.sendMessageHandler}>\n            <div className=\"wrap\">\n              <input\n                onChange={this.messageChangeHandler}\n                value={this.state.message}\n                required\n                id=\"chat-message-input\"\n                type=\"text\"\n                placeholder=\"Write your message...\"\n              />\n              <i className=\"fa fa-paperclip attachment\" aria-hidden=\"true\" />\n              <button id=\"chat-message-submit\" className=\"submit\">\n                <i className=\"fa fa-paper-plane\" aria-hidden=\"true\" />\n              </button>\n            </div>\n          </form>\n        </div>\n      </Hoc>\n    );\n  }\n}\n\nconst mapStateToProps = state => {\n  return {\n    username: state.auth.username,\n    messages: state.message.messages\n  };\n};\n\nexport default connect(mapStateToProps)(Chat);\n","import React from \"react\";\nimport { Route } from \"react-router-dom\";\nimport Hoc from \"./hoc/hoc\";\n\nimport Chat from \"./containers/Chat\";\n\nconst BaseRouter = () => (\n  <Hoc>\n    <Route exact path=\"/:chatID/\" component={Chat} />\n  </Hoc>\n);\n\nexport default BaseRouter;\n","import axios from \"axios\";\nimport * as actionTypes from \"./actionTypes\";\nimport { HOST_URL } from \"../../settings\";\n\nexport const authStart = () => {\n  return {\n    type: actionTypes.AUTH_START\n  };\n};\n\nexport const authSuccess = (username, token) => {\n  return {\n    type: actionTypes.AUTH_SUCCESS,\n    token: token,\n    username: username\n  };\n};\n\nexport const authFail = error => {\n  return {\n    type: actionTypes.AUTH_FAIL,\n    error: error\n  };\n};\n\nexport const logout = () => {\n  localStorage.removeItem(\"token\");\n  localStorage.removeItem(\"username\");\n  localStorage.removeItem(\"expirationDate\");\n  return {\n    type: actionTypes.AUTH_LOGOUT\n  };\n};\n\nexport const checkAuthTimeout = expirationTime => {\n  return dispatch => {\n    setTimeout(() => {\n      dispatch(logout());\n    }, expirationTime * 1000);\n  };\n};\n\nexport const authLogin = (username, password) => {\n  return dispatch => {\n    dispatch(authStart());\n    axios\n      .post(`${HOST_URL}/rest-auth/login/`, {\n        username: username,\n        password: password\n      })\n      .then(res => {\n        const token = res.data.key;\n        const expirationDate = new Date(new Date().getTime() + 3600 * 1000);\n        localStorage.setItem(\"token\", token);\n        localStorage.setItem(\"username\", username);\n        localStorage.setItem(\"expirationDate\", expirationDate);\n        dispatch(authSuccess(username, token));\n        dispatch(checkAuthTimeout(3600));\n      })\n      .catch(err => {\n        dispatch(authFail(err));\n      });\n  };\n};\n\nexport const authSignup = (username, email, password1, password2) => {\n  return dispatch => {\n    dispatch(authStart());\n    axios\n      .post(`${HOST_URL}/rest-auth/registration/`, {\n        username: username,\n        email: email,\n        password1: password1,\n        password2: password2\n      })\n      .then(res => {\n        const token = res.data.key;\n        const expirationDate = new Date(new Date().getTime() + 3600 * 1000);\n        localStorage.setItem(\"token\", token);\n        localStorage.setItem(\"username\", username);\n        localStorage.setItem(\"expirationDate\", expirationDate);\n        dispatch(authSuccess(username, token));\n        dispatch(checkAuthTimeout(3600));\n      })\n      .catch(err => {\n        dispatch(authFail(err));\n      });\n  };\n};\n\nexport const authCheckState = () => {\n  return dispatch => {\n    const token = localStorage.getItem(\"token\");\n    const username = localStorage.getItem(\"username\");\n    if (token === undefined) {\n      dispatch(logout());\n    } else {\n      const expirationDate = new Date(localStorage.getItem(\"expirationDate\"));\n      if (expirationDate <= new Date()) {\n        dispatch(logout());\n      } else {\n        dispatch(authSuccess(username, token));\n        dispatch(\n          checkAuthTimeout(\n            (expirationDate.getTime() - new Date().getTime()) / 1000\n          )\n        );\n      }\n    }\n  };\n};\n","import axios from \"axios\";\nimport * as actionTypes from \"./actionTypes\";\nimport { HOST_URL } from \"../../settings\";\n\nexport const addMessage = message => {\n  return {\n    type: actionTypes.ADD_MESSAGE,\n    message: message\n  };\n};\n\nexport const setMessages = messages => {\n  return {\n    type: actionTypes.SET_MESSAGES,\n    messages: messages\n  };\n};\n\nconst getUserChatsSuccess = chats => {\n  return {\n    type: actionTypes.GET_CHATS_SUCCESS,\n    chats: chats\n  };\n};\n\nexport const getUserChats = (username, token) => {\n  return dispatch => {\n    axios.defaults.headers = {\n      \"Content-Type\": \"application/json\",\n      Authorization: `Token ${token}`\n    };\n    axios\n      .get(`${HOST_URL}/chat/?username=${username}`)\n      .then(res => dispatch(getUserChatsSuccess(res.data)));\n  };\n};\n","import React from \"react\";\nimport { NavLink } from \"react-router-dom\";\n\nconst Contact = props => (\n  <NavLink to={`${props.chatURL}`} style={{ color: \"#fff\" }}>\n    <li className=\"contact\">\n      <div className=\"wrap\">\n        <span className={`contact-status ${props.status}`} />\n        <img src={props.picURL} alt=\"\" />\n        <div className=\"meta\">\n          <p className=\"name\">{props.name}</p>\n          {/* <p className=\"preview\">You just got LITT up, Mike.</p> */}\n        </div>\n      </div>\n    </li>\n  </NavLink>\n);\n\nexport default Contact;\n","import React from \"react\";\nimport { Spin, Icon } from \"antd\";\nimport { connect } from \"react-redux\";\nimport * as actions from \"../store/actions/auth\";\nimport * as navActions from \"../store/actions/nav\";\nimport * as messageActions from \"../store/actions/message\";\nimport Contact from \"../components/Contact\";\n\nconst antIcon = <Icon type=\"loading\" style={{ fontSize: 24 }} spin />;\n\nclass Sidepanel extends React.Component {\n  state = {\n    loginForm: true\n  };\n\n  waitForAuthDetails() {\n    const component = this;\n    setTimeout(function() {\n      if (\n        component.props.token !== null &&\n        component.props.token !== undefined\n      ) {\n        component.props.getUserChats(\n          component.props.username,\n          component.props.token\n        );\n        return;\n      } else {\n        console.log(\"waiting for authentication details...\");\n        component.waitForAuthDetails();\n      }\n    }, 100);\n  }\n\n  componentDidMount() {\n    this.waitForAuthDetails();\n  }\n\n  openAddChatPopup() {\n    this.props.addChat();\n  }\n\n  changeForm = () => {\n    this.setState({ loginForm: !this.state.loginForm });\n  };\n\n  authenticate = e => {\n    e.preventDefault();\n    if (this.state.loginForm) {\n      this.props.login(e.target.username.value, e.target.password.value);\n    } else {\n      this.props.signup(\n        e.target.username.value,\n        e.target.email.value,\n        e.target.password.value,\n        e.target.password2.value\n      );\n    }\n  };\n\n  render() {\n    let activeChats = this.props.chats.map(c => {\n      return (\n        <Contact\n          key={c.id}\n          name=\"Harvey Specter\"\n          picURL=\"http://emilcarlsson.se/assets/louislitt.png\"\n          status=\"busy\"\n          chatURL={`/${c.id}`}\n        />\n      );\n    });\n    return (\n      <div id=\"sidepanel\">\n        <div id=\"profile\">\n          <div className=\"wrap\">\n            <img\n              id=\"profile-img\"\n              src=\"http://emilcarlsson.se/assets/mikeross.png\"\n              className=\"online\"\n              alt=\"\"\n            />\n            <p>Mike Ross</p>\n            <i\n              className=\"fa fa-chevron-down expand-button\"\n              aria-hidden=\"true\"\n            />\n            <div id=\"status-options\">\n              <ul>\n                <li id=\"status-online\" className=\"active\">\n                  <span className=\"status-circle\" /> <p>Online</p>\n                </li>\n                <li id=\"status-away\">\n                  <span className=\"status-circle\" /> <p>Away</p>\n                </li>\n                <li id=\"status-busy\">\n                  <span className=\"status-circle\" /> <p>Busy</p>\n                </li>\n                <li id=\"status-offline\">\n                  <span className=\"status-circle\" /> <p>Offline</p>\n                </li>\n              </ul>\n            </div>\n            <div id=\"expanded\">\n              {this.props.loading ? (\n                <Spin indicator={antIcon} />\n              ) : this.props.isAuthenticated ? (\n                <button onClick={() => this.props.logout()} className=\"authBtn\">\n                  <span>Logout</span>\n                </button>\n              ) : (\n                <div>\n                  <form method=\"POST\" onSubmit={this.authenticate}>\n                    {this.state.loginForm ? (\n                      <div>\n                        <input\n                          name=\"username\"\n                          type=\"text\"\n                          placeholder=\"username\"\n                        />\n                        <input\n                          name=\"password\"\n                          type=\"password\"\n                          placeholder=\"password\"\n                        />\n                      </div>\n                    ) : (\n                      <div>\n                        <input\n                          name=\"username\"\n                          type=\"text\"\n                          placeholder=\"username\"\n                        />\n                        <input name=\"email\" type=\"email\" placeholder=\"email\" />\n                        <input\n                          name=\"password\"\n                          type=\"password\"\n                          placeholder=\"password\"\n                        />\n                        <input\n                          name=\"password2\"\n                          type=\"password\"\n                          placeholder=\"password confirm\"\n                        />\n                      </div>\n                    )}\n\n                    <button type=\"submit\">Authenticate</button>\n                  </form>\n\n                  <button onClick={this.changeForm}>Switch</button>\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n        <div id=\"search\">\n          <label htmlFor=\"\">\n            <i className=\"fa fa-search\" aria-hidden=\"true\" />\n          </label>\n          <input type=\"text\" placeholder=\"Search Chats...\" />\n        </div>\n        <div id=\"contacts\">\n          <ul>{activeChats}</ul>\n        </div>\n        <div id=\"bottom-bar\">\n          <button id=\"addChat\" onClick={() => this.openAddChatPopup()}>\n            <i className=\"fa fa-user-plus fa-fw\" aria-hidden=\"true\" />\n            <span>Create chat</span>\n          </button>\n          <button id=\"settings\">\n            <i className=\"fa fa-cog fa-fw\" aria-hidden=\"true\" />\n            <span>Settings</span>\n          </button>\n        </div>\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = state => {\n  return {\n    isAuthenticated: state.auth.token !== null,\n    loading: state.auth.loading,\n    token: state.auth.token,\n    username: state.auth.username,\n    chats: state.message.chats\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    login: (userName, password) =>\n      dispatch(actions.authLogin(userName, password)),\n    logout: () => dispatch(actions.logout()),\n    signup: (username, email, password1, password2) =>\n      dispatch(actions.authSignup(username, email, password1, password2)),\n    addChat: () => dispatch(navActions.openAddChatPopup()),\n    getUserChats: (username, token) =>\n      dispatch(messageActions.getUserChats(username, token))\n  };\n};\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Sidepanel);\n","import * as actionTypes from \"./actionTypes\";\n\nexport const openAddChatPopup = () => {\n  return {\n    type: actionTypes.OPEN_ADD_CHAT_POPUP\n  };\n};\n\nexport const closeAddChatPopup = () => {\n  return {\n    type: actionTypes.CLOSE_ADD_CHAT_POPUP\n  };\n};\n","import React from \"react\";\nimport { connect } from \"react-redux\";\nimport { Redirect } from \"react-router-dom\";\nimport Hoc from \"../hoc/hoc\";\n\nclass Profile extends React.Component {\n  render() {\n    if (this.props.token === null) {\n      return <Redirect to=\"/\" />;\n    }\n    return (\n      <div className=\"contact-profile\">\n        {this.props.username !== null ? (\n          <Hoc>\n            <img src=\"http://emilcarlsson.se/assets/harveyspecter.png\" alt=\"\" />\n            <p>{this.props.username}</p>\n            <div className=\"social-media\">\n              <i className=\"fa fa-facebook\" aria-hidden=\"true\" />\n              <i className=\"fa fa-twitter\" aria-hidden=\"true\" />\n              <i className=\"fa fa-instagram\" aria-hidden=\"true\" />\n            </div>\n          </Hoc>\n        ) : null}\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = state => {\n  return {\n    username: state.auth.username,\n    token: state.auth.token\n  };\n};\n\nexport default connect(mapStateToProps)(Profile);\n","import React from \"react\";\nimport { Form, Button, Select } from \"antd\";\nimport axios from \"axios\";\nimport { connect } from \"react-redux\";\nimport { withRouter } from \"react-router-dom\";\nimport * as navActions from \"../store/actions/nav\";\nimport * as messageActions from \"../store/actions/message\";\nimport { HOST_URL } from \"../settings\";\n\nconst FormItem = Form.Item;\n\nfunction hasErrors(fieldsError) {\n  return Object.keys(fieldsError).some(field => fieldsError[field]);\n}\n\nclass HorizontalAddChatForm extends React.Component {\n  state = {\n    usernames: [],\n    error: null\n  };\n\n  handleChange = value => {\n    this.setState({\n      usernames: value\n    });\n  };\n\n  componentDidMount() {\n    this.props.form.validateFields();\n  }\n\n  handleSubmit = e => {\n    const { usernames } = this.state;\n    e.preventDefault();\n    this.props.form.validateFields((err, values) => {\n      if (!err) {\n        const combined = [...usernames, this.props.username];\n        console.log(combined);\n        axios.defaults.headers = {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Token ${this.props.token}`\n        };\n        axios\n          .post(`${HOST_URL}/chat/create/`, {\n            messages: [],\n            participants: combined\n          })\n          .then(res => {\n            this.props.history.push(`/${res.data.id}`);\n            this.props.closeAddChatPopup();\n            this.props.getUserChats(this.props.username, this.props.token);\n          })\n          .catch(err => {\n            console.error(err);\n            this.setState({\n              error: err\n            });\n          });\n      }\n    });\n  };\n\n  render() {\n    const {\n      getFieldDecorator,\n      getFieldsError,\n      getFieldError,\n      isFieldTouched\n    } = this.props.form;\n\n    const userNameError =\n      isFieldTouched(\"userName\") && getFieldError(\"userName\");\n    return (\n      <Form layout=\"inline\" onSubmit={this.handleSubmit}>\n        {this.state.error ? `${this.state.error}` : null}\n        <FormItem\n          validateStatus={userNameError ? \"error\" : \"\"}\n          help={userNameError || \"\"}\n        >\n          {getFieldDecorator(\"userName\", {\n            rules: [\n              {\n                required: true,\n                message:\n                  \"Please input the username of the person you want to chat with\"\n              }\n            ]\n          })(\n            <Select\n              mode=\"tags\"\n              style={{ width: \"100%\" }}\n              placeholder=\"Tags Mode\"\n              onChange={this.handleChange}\n            >\n              {[]}\n            </Select>\n          )}\n        </FormItem>\n        <FormItem>\n          <Button\n            type=\"primary\"\n            htmlType=\"submit\"\n            disabled={hasErrors(getFieldsError())}\n          >\n            Start a chat\n          </Button>\n        </FormItem>\n      </Form>\n    );\n  }\n}\n\nconst AddChatForm = Form.create()(HorizontalAddChatForm);\n\nconst mapStateToProps = state => {\n  return {\n    token: state.auth.token,\n    username: state.auth.username\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    closeAddChatPopup: () => dispatch(navActions.closeAddChatPopup()),\n    getUserChats: (username, token) =>\n      dispatch(messageActions.getUserChats(username, token))\n  };\n};\n\nexport default withRouter(\n  connect(\n    mapStateToProps,\n    mapDispatchToProps\n  )(AddChatForm)\n);\n","import React from \"react\";\nimport { Modal } from \"antd\";\nimport Form from \"./Form\";\n\nclass AddChatModal extends React.Component {\n  render() {\n    return (\n      <Modal\n        centered\n        footer={null}\n        visible={this.props.isVisible}\n        onCancel={this.props.close}\n      >\n        <Form />\n      </Modal>\n    );\n  }\n}\n\nexport default AddChatModal;\n","import React from \"react\";\nimport { connect } from \"react-redux\";\nimport { BrowserRouter as Router } from \"react-router-dom\";\nimport BaseRouter from \"./routes\";\nimport Sidepanel from \"./containers/Sidepanel\";\nimport Profile from \"./containers/Profile\";\nimport AddChatModal from \"./containers/Popup\";\nimport * as actions from \"./store/actions/auth\";\nimport * as navActions from \"./store/actions/nav\";\nimport * as messageActions from \"./store/actions/message\";\nimport WebSocketInstance from \"./websocket\";\nimport \"./assets/style.css\";\n\nclass App extends React.Component {\n  componentDidMount() {\n    this.props.onTryAutoSignup();\n  }\n\n  constructor(props) {\n    super(props);\n    WebSocketInstance.addCallbacks(\n      this.props.setMessages.bind(this),\n      this.props.addMessage.bind(this)\n    );\n  }\n\n  render() {\n    return (\n      <Router>\n        <div id=\"frame\">\n          <Sidepanel />\n          <div className=\"content\">\n            <AddChatModal\n              isVisible={this.props.showAddChatPopup}\n              close={() => this.props.closeAddChatPopup()}\n            />\n            <Profile />\n            <BaseRouter />\n          </div>\n        </div>\n      </Router>\n    );\n  }\n}\n\nconst mapStateToProps = state => {\n  return {\n    showAddChatPopup: state.nav.showAddChatPopup,\n    authenticated: state.auth.token\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    onTryAutoSignup: () => dispatch(actions.authCheckState()),\n    closeAddChatPopup: () => dispatch(navActions.closeAddChatPopup()),\n    addMessage: message => dispatch(messageActions.addMessage(message)),\n    setMessages: messages => dispatch(messageActions.setMessages(messages))\n  };\n};\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(App);\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { createStore, compose, applyMiddleware, combineReducers } from \"redux\";\nimport { Provider } from \"react-redux\";\nimport thunk from \"redux-thunk\";\nimport \"antd/dist/antd.css\";\nimport authReducer from \"./store/reducers/auth\";\nimport navReducer from \"./store/reducers/nav\";\nimport messageReducer from \"./store/reducers/message\";\nimport App from \"./App\";\n\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\n\nfunction configureStore() {\n  const rootReducer = combineReducers({\n    auth: authReducer,\n    nav: navReducer,\n    message: messageReducer\n  });\n\n  const store = createStore(\n    rootReducer,\n    composeEnhancers(applyMiddleware(thunk))\n  );\n\n  //   if (module.hot) {\n  //     module.hot.accept(\"./store/reducers\", () => {\n  //       const nextRootReducer = require(\"./store/reducers/auth\");\n  //       store.replaceReducer(nextRootReducer);\n  //     });\n  //   }\n\n  return store;\n}\n\nconst store = configureStore();\n\nconst app = (\n  <Provider store={store}>\n    <App />\n  </Provider>\n);\n\nReactDOM.render(app, document.getElementById(\"app\"));\n"],"sourceRoot":""}